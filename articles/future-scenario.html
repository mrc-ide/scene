<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="scene">
<title>Future scenario • scene</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Future scenario">
<meta property="og:description" content="scene">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">scene</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/future-scenario.html">Future scenario</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Future scenario</h1>
            
      
      
      <div class="d-none name"><code>future-scenario.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">scene</span><span class="op">)</span></span></code></pre></div>
<p>Using a site file in malariariaverse, we can define a future scenario
by extending and populating the <code>$interventions</code> section for
a site to include future years. Scene provides helpful functions to help
us build our future scenarios.</p>
<p>Let’s start with an example site. We can see the interventions
sections has details of the historical intervention coverage for the
last 5 years:</p>
<table class="table">
<thead><tr>
<th style="text-align:left;">
country
</th>
<th style="text-align:left;">
site
</th>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
itn_use
</th>
<th style="text-align:right;">
itn_input_dist
</th>
<th style="text-align:right;">
tx_cov
</th>
<th style="text-align:right;">
irs_cov
</th>
<th style="text-align:right;">
rtss_cov
</th>
<th style="text-align:right;">
smc_cov
</th>
<th style="text-align:right;">
pmc_cov
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>We can plot the interventions (aggregated for the country and at the
site level) to get an idea of what is going on:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_interventions_combined.html">plot_interventions_combined</a></span><span class="op">(</span></span>
<span>  interventions <span class="op">=</span> <span class="va">example_site</span><span class="op">$</span><span class="va">interventions</span>,</span>
<span>  population <span class="op">=</span> <span class="va">example_site</span><span class="op">$</span><span class="va">population</span>,</span>
<span>  group_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"site"</span><span class="op">)</span>,</span>
<span>  include <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"itn_use"</span>, <span class="st">"itn_input_dist"</span>, <span class="st">"tx_cov"</span>, <span class="st">"smc_cov"</span><span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ITN usage"</span>, <span class="st">"ITN model input"</span>, <span class="st">"Treatment"</span>,<span class="st">"SMC"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="future-scenario_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>Let’s start by creating a new site file for our new scenario. We also
define the grouping variable(s), to inform the sites with in the site
file:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_scenario</span> <span class="op">&lt;-</span> <span class="va">example_site</span></span>
<span><span class="va">group_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">new_scenario</span><span class="op">$</span><span class="va">sites</span><span class="op">)</span></span></code></pre></div>
<p>We need to expand our <code>$interventions</code> section to some
future years:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Expand the interventions for each site in the site file up to year 10</span></span>
<span><span class="va">new_scenario</span><span class="op">$</span><span class="va">interventions</span> <span class="op">&lt;-</span> <span class="va">new_scenario</span><span class="op">$</span><span class="va">interventions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/expand_interventions.html">expand_interventions</a></span><span class="op">(</span>max_year <span class="op">=</span> <span class="fl">10</span>, group_var <span class="op">=</span> <span class="va">group_var</span><span class="op">)</span></span></code></pre></div>
<p>After this we can begin to populate “the future” interventions for
our scenario, we can do this be adding target change points in the
<code>$inteventions</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add a target ITN usage of 60% in all sites by year 8</span></span>
<span><span class="va">new_scenario</span><span class="op">$</span><span class="va">interventions</span> <span class="op">&lt;-</span> <span class="va">new_scenario</span><span class="op">$</span><span class="va">interventions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_change_point.html">set_change_point</a></span><span class="op">(</span>sites <span class="op">=</span> <span class="va">new_scenario</span><span class="op">$</span><span class="va">sites</span>, var <span class="op">=</span> <span class="st">"itn_use"</span>, year <span class="op">=</span> <span class="fl">8</span>, target <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></code></pre></div>
<p>We can define more specific options, restricting sites where changes
will be implemented:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add a target PMC coverage of 80% in site A</span></span>
<span><span class="va">to_get_pmc</span> <span class="op">&lt;-</span> <span class="va">new_scenario</span><span class="op">$</span><span class="va">sites</span><span class="op">[</span><span class="va">new_scenario</span><span class="op">$</span><span class="va">sites</span><span class="op">$</span><span class="va">site</span> <span class="op">==</span> <span class="st">"A"</span>, <span class="op">]</span></span>
<span><span class="va">new_scenario</span><span class="op">$</span><span class="va">interventions</span> <span class="op">&lt;-</span> <span class="va">new_scenario</span><span class="op">$</span><span class="va">interventions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_change_point.html">set_change_point</a></span><span class="op">(</span>sites <span class="op">=</span> <span class="va">to_get_pmc</span>, var <span class="op">=</span> <span class="st">"pmc_cov"</span>, year <span class="op">=</span> <span class="fl">10</span>, target <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add a target SMC coverage of 50% to any sites that have previously implemented SMC</span></span>
<span><span class="va">to_get_smc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ever_used.html">ever_used</a></span><span class="op">(</span></span>
<span>  interventions <span class="op">=</span> <span class="va">example_site</span><span class="op">$</span><span class="va">interventions</span>,</span>
<span>  var <span class="op">=</span> <span class="st">"smc_cov"</span>,</span>
<span>  group_var <span class="op">=</span> <span class="va">group_var</span></span>
<span><span class="op">)</span></span>
<span><span class="va">new_scenario</span><span class="op">$</span><span class="va">interventions</span> <span class="op">&lt;-</span> <span class="va">new_scenario</span><span class="op">$</span><span class="va">interventions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_change_point.html">set_change_point</a></span><span class="op">(</span>sites <span class="op">=</span> <span class="va">to_get_smc</span>, var <span class="op">=</span> <span class="st">"smc_cov"</span>, year <span class="op">=</span> <span class="fl">10</span>, target <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p>Now we have defined our targets, we can see there are still missing
values in <code>$interventions</code>:</p>
<table class="table">
<thead><tr>
<th style="text-align:left;">
country
</th>
<th style="text-align:left;">
site
</th>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
itn_use
</th>
<th style="text-align:right;">
itn_input_dist
</th>
<th style="text-align:right;">
tx_cov
</th>
<th style="text-align:right;">
irs_cov
</th>
<th style="text-align:right;">
rtss_cov
</th>
<th style="text-align:right;">
smc_cov
</th>
<th style="text-align:right;">
pmc_cov
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.6
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.6
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<p>Let’s fill them in! For some interventions we might want coverage to
scale up to a target:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Linear scale up of coverage</span></span>
<span><span class="va">new_scenario</span><span class="op">$</span><span class="va">interventions</span> <span class="op">&lt;-</span> <span class="va">new_scenario</span><span class="op">$</span><span class="va">interventions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/linear_interpolate.html">linear_interpolate</a></span><span class="op">(</span>vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"itn_use"</span>, <span class="st">"pmc_cov"</span>, <span class="st">"smc_cov"</span><span class="op">)</span>, group_var <span class="op">=</span> <span class="va">group_var</span><span class="op">)</span></span></code></pre></div>
<p>For others we may just want the previous value to be carried
forward:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_scenario</span><span class="op">$</span><span class="va">interventions</span> <span class="op">&lt;-</span> <span class="va">new_scenario</span><span class="op">$</span><span class="va">interventions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/fill_extrapolate.html">fill_extrapolate</a></span><span class="op">(</span>group_var <span class="op">=</span> <span class="va">group_var</span><span class="op">)</span></span></code></pre></div>
<p>Now we have future net usage defined, we need to estimate the model
input net distribution to achieve it. We use the
<code><a href="../reference/add_future_net_dist.html">add_future_net_dist()</a></code>. Note that this function imposes some
very specific assumptions so make sure you are familiar with
<code><a href="https://rdrr.io/pkg/netz/man/fit_usage.html" class="external-link">netz::fit_usage()</a></code> before using!</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_scenario</span><span class="op">$</span><span class="va">interventions</span> <span class="op">&lt;-</span> <span class="va">new_scenario</span><span class="op">$</span><span class="va">interventions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_future_net_dist.html">add_future_net_dist</a></span><span class="op">(</span>group_var <span class="op">=</span> <span class="va">group_var</span><span class="op">)</span></span></code></pre></div>
<p>Ok, now we should have a populated <code>$interventions</code>:</p>
<table class="table">
<thead><tr>
<th style="text-align:left;">
country
</th>
<th style="text-align:left;">
site
</th>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
itn_use
</th>
<th style="text-align:right;">
itn_input_dist
</th>
<th style="text-align:right;">
tx_cov
</th>
<th style="text-align:right;">
irs_cov
</th>
<th style="text-align:right;">
rtss_cov
</th>
<th style="text-align:right;">
smc_cov
</th>
<th style="text-align:right;">
pmc_cov
</th>
<th style="text-align:right;">
fitted_usage
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.1000000
</td>
<td style="text-align:right;">
0.1100000
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.0995594
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.2000000
</td>
<td style="text-align:right;">
0.1400000
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.1968126
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.4000000
</td>
<td style="text-align:right;">
0.3200000
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.3992001
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.4000000
</td>
<td style="text-align:right;">
0.1300000
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.4020097
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.4666667
</td>
<td style="text-align:right;">
0.2000000
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.4443272
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.5333333
</td>
<td style="text-align:right;">
0.3986168
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.5795560
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.6000000
</td>
<td style="text-align:right;">
0.2000000
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.48
</td>
<td style="text-align:right;">
0.5606173
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0.6000000
</td>
<td style="text-align:right;">
0.2000000
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.64
</td>
<td style="text-align:right;">
0.5482128
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.6000000
</td>
<td style="text-align:right;">
0.3320723
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
0.6003455
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.1000000
</td>
<td style="text-align:right;">
0.1100000
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.0995594
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.2000000
</td>
<td style="text-align:right;">
0.1400000
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.1968126
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.4000000
</td>
<td style="text-align:right;">
0.3200000
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.3992001
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.4000000
</td>
<td style="text-align:right;">
0.1300000
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.4020097
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.4666667
</td>
<td style="text-align:right;">
0.2000000
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.74
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.4443272
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.5333333
</td>
<td style="text-align:right;">
0.3986168
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.68
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.5795560
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.6000000
</td>
<td style="text-align:right;">
0.2000000
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.5606173
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0.6000000
</td>
<td style="text-align:right;">
0.2000000
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.5482128
</td>
</tr>
<tr>
<td style="text-align:left;">
Eg
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.6000000
</td>
<td style="text-align:right;">
0.3320723
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.6003455
</td>
</tr>
</tbody>
</table>
<p>Let’s inspect the interventions for our new scenario to confirm our
changes have worked as expected:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_interventions_combined.html">plot_interventions_combined</a></span><span class="op">(</span></span>
<span>  interventions <span class="op">=</span> <span class="va">new_scenario</span><span class="op">$</span><span class="va">interventions</span>,</span>
<span>  population <span class="op">=</span> <span class="va">new_scenario</span><span class="op">$</span><span class="va">population</span>,</span>
<span>  group_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"site"</span><span class="op">)</span>,</span>
<span>  include <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"itn_use"</span>, <span class="st">"itn_input_dist"</span>, <span class="st">"fitted_usage"</span>, <span class="st">"tx_cov"</span>, <span class="st">"smc_cov"</span>, <span class="st">"pmc_cov"</span><span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ITN usage"</span>, <span class="st">"ITN model input"</span>,<span class="st">"ITN model usage"</span>, <span class="st">"Treatment"</span>,<span class="st">"SMC"</span>, <span class="st">"PMC"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="future-scenario_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<p>We now have a fully populated new scenario. In reality, there is more
complexity in site file interventions than shown here, but most of the
principals remain the same. Note that the order of operations does
matter - for example you can’t estimate <code>itn_input_dist</code>
before specifying <code>itn_use</code> and you can’t
<code><a href="../reference/linear_interpolate.html">linear_interpolate()</a></code> a variable after
<code><a href="../reference/fill_extrapolate.html">fill_extrapolate()</a></code>.</p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Pete Winskill.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
